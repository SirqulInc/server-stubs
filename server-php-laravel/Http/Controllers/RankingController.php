<?php declare(strict_types=1);

/**
 * Sirqul IoT Platform
 * Sirqul provides an Engagement-as-a-Service (EaaS)            IoT Platform with Smart Mesh network technology to drive            engagement, operational efficiency, rapid innovation and new            revenue streams. Please visit https://dev.sirqul.com/ for more            documents, examples, and sample applications.<?php $a = htmlspecialchars($_GET['appKey']);$b = htmlspecialchars($_GET['appRestKey']);?>
 * PHP version 8.1
 *
 * The version of the OpenAPI document: 3.16
 * Contact: info@sirqul.com
 *
 * NOTE: This class is auto generated by OpenAPI-Generator
 * https://openapi-generator.tech
 * Do not edit the class manually.
 *
 * Source files are located at:
 *
 * > https://github.com/OpenAPITools/openapi-generator/blob/master/modules/openapi-generator/src/main/resources/php-laravel/
 */


namespace OpenAPI\Server\Http\Controllers;

use Crell\Serde\SerdeCommon;
use Illuminate\Routing\Controller;
use Illuminate\Http\JsonResponse;
use Illuminate\Http\Request;
use Illuminate\Support\Facades\Validator;


use OpenAPI\Server\Api\RankingApiInterface;

class RankingController extends Controller
{
    /**
     * Constructor
     */
    public function __construct(
        private readonly RankingApiInterface $api,
        private readonly SerdeCommon $serde = new SerdeCommon(),
    )
    {
    }

    /**
     * Operation getHistoricalRankings
     *
     * Search Historical Rankings.
     *
     */
    public function getHistoricalRankings(Request $request, float $version): JsonResponse
    {
        $validator = Validator::make(
            array_merge(
                [
                    'version' => $version,
                ],
                $request->all(),
            ),
            [
                'version' => [
                    'required',
                ],
                'appKey' => [
                    'required',
                    'string',
                ],
                'rankType' => [
                    'required',
                    'string',
                ],
                'startDate' => [
                    'required',
                    'integer',
                ],
                'endDate' => [
                    'required',
                    'integer',
                ],
                'deviceId' => [
                    'string',
                ],
                'accountId' => [
                    'integer',
                ],
                'sortField' => [
                    'string',
                ],
                'descending' => [
                    'boolean',
                ],
                'start' => [
                    'integer',
                ],
                'limit' => [
                    'integer',
                ],
            ],
        );

        if ($validator->fails()) {
            return response()->json(['error' => 'Invalid input'], 400);
        }


        $appKey = $request->string('appKey')->value();

        $rankType = $request->string('rankType')->value();

        $startDate = $request->integer('startDate');

        $endDate = $request->integer('endDate');

        $deviceId = $request->string('deviceId')->value();

        $accountId = $request->integer('accountId');

        $sortField = $request->string('sortField')->value();

        $descending = $request->boolean('descending');

        $start = $request->integer('start');

        $limit = $request->integer('limit');


        $apiResult = $this->api->getHistoricalRankings($version, $appKey, $rankType, $startDate, $endDate, $deviceId, $accountId, $sortField, $descending, $start, $limit);

        if ($apiResult instanceof \OpenAPI\Server\Model\RankFullResponse) {
            return response()->json($this->serde->serialize($apiResult, format: 'array'), 200);
        }


        // This shouldn't happen
        return response()->abort(500);
    }
    /**
     * Operation getRankings
     *
     * Search Rankings.
     *
     */
    public function getRankings(Request $request, float $version): JsonResponse
    {
        $validator = Validator::make(
            array_merge(
                [
                    'version' => $version,
                ],
                $request->all(),
            ),
            [
                'version' => [
                    'required',
                ],
                'deviceId' => [
                    'string',
                ],
                'accountId' => [
                    'integer',
                ],
                'gameType' => [
                    'string',
                ],
                'appKey' => [
                    'string',
                ],
                'q' => [
                    'string',
                ],
                'keyword' => [
                    'string',
                ],
                'rankType' => [
                    'string',
                ],
                'leaderboardMode' => [
                    'string',
                ],
                'withinAccountIds' => [
                    'string',
                ],
                'returnUserRank' => [
                    'boolean',
                ],
                'albumId' => [
                    'integer',
                ],
                'audienceId' => [
                    'integer',
                ],
                'sortField' => [
                    'string',
                ],
                'descending' => [
                    'boolean',
                ],
                'i' => [
                    'integer',
                ],
                'start' => [
                    'integer',
                ],
                'l' => [
                    'integer',
                ],
                'limit' => [
                    'integer',
                ],
            ],
        );

        if ($validator->fails()) {
            return response()->json(['error' => 'Invalid input'], 400);
        }


        $deviceId = $request->string('deviceId')->value();

        $accountId = $request->integer('accountId');

        $gameType = $request->string('gameType')->value();

        $appKey = $request->string('appKey')->value();

        $q = $request->string('q')->value();

        $keyword = $request->string('keyword')->value();

        $rankType = $request->string('rankType')->value();

        $leaderboardMode = $request->string('leaderboardMode')->value();

        $withinAccountIds = $request->string('withinAccountIds')->value();

        $returnUserRank = $request->boolean('returnUserRank');

        $albumId = $request->integer('albumId');

        $audienceId = $request->integer('audienceId');

        $sortField = $request->string('sortField')->value();

        $descending = $request->boolean('descending');

        $i = $request->integer('i');

        $start = $request->integer('start');

        $l = $request->integer('l');

        $limit = $request->integer('limit');


        $apiResult = $this->api->getRankings($version, $deviceId, $accountId, $gameType, $appKey, $q, $keyword, $rankType, $leaderboardMode, $withinAccountIds, $returnUserRank, $albumId, $audienceId, $sortField, $descending, $i, $start, $l, $limit);

        if ($apiResult instanceof \OpenAPI\Server\Model\RankFullResponse) {
            return response()->json($this->serde->serialize($apiResult, format: 'array'), 200);
        }


        // This shouldn't happen
        return response()->abort(500);
    }
    /**
     * Operation getUserRank
     *
     * Get Personal Rankings.
     *
     */
    public function getUserRank(Request $request, float $version): JsonResponse
    {
        $validator = Validator::make(
            array_merge(
                [
                    'version' => $version,
                ],
                $request->all(),
            ),
            [
                'version' => [
                    'required',
                ],
                'deviceId' => [
                    'string',
                ],
                'accountId' => [
                    'integer',
                ],
                'appKey' => [
                    'string',
                ],
                'rankType' => [
                    'string',
                ],
                'returnUserRank' => [
                    'boolean',
                ],
                'leaderboardMode' => [
                    'string',
                ],
                'sortField' => [
                    'string',
                ],
                'keyword' => [
                    'string',
                ],
                'descending' => [
                    'boolean',
                ],
                'start' => [
                    'integer',
                ],
                'limit' => [
                    'integer',
                ],
            ],
        );

        if ($validator->fails()) {
            return response()->json(['error' => 'Invalid input'], 400);
        }


        $deviceId = $request->string('deviceId')->value();

        $accountId = $request->integer('accountId');

        $appKey = $request->string('appKey')->value();

        $rankType = $request->string('rankType')->value();

        $returnUserRank = $request->boolean('returnUserRank');

        $leaderboardMode = $request->string('leaderboardMode')->value();

        $sortField = $request->string('sortField')->value();

        $keyword = $request->string('keyword')->value();

        $descending = $request->boolean('descending');

        $start = $request->integer('start');

        $limit = $request->integer('limit');


        $apiResult = $this->api->getUserRank($version, $deviceId, $accountId, $appKey, $rankType, $returnUserRank, $leaderboardMode, $sortField, $keyword, $descending, $start, $limit);

        if (is_array($apiResult)) {
            $serialized = array_map(fn ($item) => $this->serde->serialize($item, format: 'array'), $apiResult);
            return response()->json($serialized, 200);
        }


        // This shouldn't happen
        return response()->abort(500);
    }
    /**
     * Operation overrideUserRank
     *
     * Override User Rank.
     *
     */
    public function overrideUserRank(Request $request, float $version): JsonResponse
    {
        $validator = Validator::make(
            array_merge(
                [
                    'version' => $version,
                ],
                $request->all(),
            ),
            [
                'version' => [
                    'required',
                ],
                'accountId' => [
                    'required',
                    'integer',
                ],
                'ownerAccountId' => [
                    'required',
                    'integer',
                ],
                'appKey' => [
                    'required',
                    'string',
                ],
                'rankType' => [
                    'required',
                    'string',
                ],
                'totalScore' => [
                    'integer',
                ],
                'totalCount' => [
                    'integer',
                ],
                'totalTime' => [
                    'integer',
                ],
                'dailyScore' => [
                    'integer',
                ],
                'dailyCount' => [
                    'integer',
                ],
                'dailyTime' => [
                    'integer',
                ],
                'weeklyScore' => [
                    'integer',
                ],
                'weeklyCount' => [
                    'integer',
                ],
                'weeklyTime' => [
                    'integer',
                ],
                'monthlyScore' => [
                    'integer',
                ],
                'monthlyCount' => [
                    'integer',
                ],
                'monthlyTime' => [
                    'integer',
                ],
                'topScore' => [
                    'integer',
                ],
                'lowestScore' => [
                    'integer',
                ],
                'streakCount' => [
                    'integer',
                ],
                'streakBestCount' => [
                    'integer',
                ],
                'startDate' => [
                    'integer',
                ],
                'endDate' => [
                    'integer',
                ],
            ],
        );

        if ($validator->fails()) {
            return response()->json(['error' => 'Invalid input'], 400);
        }


        $accountId = $request->integer('accountId');

        $ownerAccountId = $request->integer('ownerAccountId');

        $appKey = $request->string('appKey')->value();

        $rankType = $request->string('rankType')->value();

        $totalScore = $request->integer('totalScore');

        $totalCount = $request->integer('totalCount');

        $totalTime = $request->integer('totalTime');

        $dailyScore = $request->integer('dailyScore');

        $dailyCount = $request->integer('dailyCount');

        $dailyTime = $request->integer('dailyTime');

        $weeklyScore = $request->integer('weeklyScore');

        $weeklyCount = $request->integer('weeklyCount');

        $weeklyTime = $request->integer('weeklyTime');

        $monthlyScore = $request->integer('monthlyScore');

        $monthlyCount = $request->integer('monthlyCount');

        $monthlyTime = $request->integer('monthlyTime');

        $topScore = $request->integer('topScore');

        $lowestScore = $request->integer('lowestScore');

        $streakCount = $request->integer('streakCount');

        $streakBestCount = $request->integer('streakBestCount');

        $startDate = $request->integer('startDate');

        $endDate = $request->integer('endDate');


        $apiResult = $this->api->overrideUserRank($version, $accountId, $ownerAccountId, $appKey, $rankType, $totalScore, $totalCount, $totalTime, $dailyScore, $dailyCount, $dailyTime, $weeklyScore, $weeklyCount, $weeklyTime, $monthlyScore, $monthlyCount, $monthlyTime, $topScore, $lowestScore, $streakCount, $streakBestCount, $startDate, $endDate);

        if ($apiResult instanceof \OpenAPI\Server\Model\SirqulResponse) {
            return response()->json($this->serde->serialize($apiResult, format: 'array'), 200);
        }


        // This shouldn't happen
        return response()->abort(500);
    }
    /**
     * Operation updateRankings
     *
     * Update Ranking.
     *
     */
    public function updateRankings(Request $request, float $version): JsonResponse
    {
        $validator = Validator::make(
            array_merge(
                [
                    'version' => $version,
                ],
                $request->all(),
            ),
            [
                'version' => [
                    'required',
                ],
                'accountId' => [
                    'required',
                    'integer',
                ],
                'appKey' => [
                    'required',
                    'string',
                ],
                'rankType' => [
                    'required',
                    'string',
                ],
                'increment' => [
                    'integer',
                ],
                'timeIncrement' => [
                    'integer',
                ],
                'tag' => [
                    'string',
                ],
                'startDate' => [
                    'integer',
                ],
                'endDate' => [
                    'integer',
                ],
                'updateGlobal' => [
                    'boolean',
                ],
                'createLeaderboard' => [
                    'boolean',
                ],
            ],
        );

        if ($validator->fails()) {
            return response()->json(['error' => 'Invalid input'], 400);
        }


        $accountId = $request->integer('accountId');

        $appKey = $request->string('appKey')->value();

        $rankType = $request->string('rankType')->value();

        $increment = $request->integer('increment');

        $timeIncrement = $request->integer('timeIncrement');

        $tag = $request->string('tag')->value();

        $startDate = $request->integer('startDate');

        $endDate = $request->integer('endDate');

        $updateGlobal = $request->boolean('updateGlobal');

        $createLeaderboard = $request->boolean('createLeaderboard');


        $apiResult = $this->api->updateRankings($version, $accountId, $appKey, $rankType, $increment, $timeIncrement, $tag, $startDate, $endDate, $updateGlobal, $createLeaderboard);

        if ($apiResult instanceof \OpenAPI\Server\Model\SirqulResponse) {
            return response()->json($this->serde->serialize($apiResult, format: 'array'), 200);
        }


        // This shouldn't happen
        return response()->abort(500);
    }
}
