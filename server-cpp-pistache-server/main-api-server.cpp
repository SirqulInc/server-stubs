/**
* Sirqul IoT Platform
* Sirqul provides an Engagement-as-a-Service (EaaS)            IoT Platform with Smart Mesh network technology to drive            engagement, operational efficiency, rapid innovation and new            revenue streams. Please visit https://dev.sirqul.com/ for more            documents, examples, and sample applications.<?php $a = htmlspecialchars($_GET['appKey']);$b = htmlspecialchars($_GET['appRestKey']);?>
*
* The version of the OpenAPI document: 3.16
* Contact: info@sirqul.com
*
* NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).
* https://openapi-generator.tech
* Do not edit the class manually.
*/


#include "pistache/endpoint.h"
#include "pistache/http.h"
#include "pistache/router.h"
#ifdef __linux__
#include <vector>
#include <signal.h>
#include <unistd.h>
#endif

#include "ApiBase.h"

#include "AMQPApiImpl.h"
#include "AccountApiImpl.h"
#include "AchievementApiImpl.h"
#include "ActivityApiImpl.h"
#include "AlbumApiImpl.h"
#include "AnalyticsApiImpl.h"
#include "AppDataApiImpl.h"
#include "ApplicationApiImpl.h"
#include "ApplicationConfigApiImpl.h"
#include "AssetApiImpl.h"
#include "AssignmentApiImpl.h"
#include "AudienceApiImpl.h"
#include "BidApiImpl.h"
#include "BillableEntityApiImpl.h"
#include "BillingInfoApiImpl.h"
#include "CSVImportApiImpl.h"
#include "CargoTypeApiImpl.h"
#include "CarrierApiImpl.h"
#include "CategoryApiImpl.h"
#include "ConnectionApiImpl.h"
#include "ContestApiImpl.h"
#include "CreativeApiImpl.h"
#include "DependentApiImpl.h"
#include "DisbursementApiImpl.h"
#include "EmployeeApiImpl.h"
#include "EventApiImpl.h"
#include "FacebookApiImpl.h"
#include "FavoriteApiImpl.h"
#include "FilterApiImpl.h"
#include "FlagApiImpl.h"
#include "GameApiImpl.h"
#include "GameLevelApiImpl.h"
#include "InviteApiImpl.h"
#include "LeaderboardApiImpl.h"
#include "LikeApiImpl.h"
#include "ListingApiImpl.h"
#include "LocationApiImpl.h"
#include "LocationApiV2ApiImpl.h"
#include "MediaApiImpl.h"
#include "MissionApiImpl.h"
#include "MissionInviteApiImpl.h"
#include "NoteApiImpl.h"
#include "NotificationApiImpl.h"
#include "ObjectStoreApiImpl.h"
#include "OfferApiImpl.h"
#include "OfferStatusApiImpl.h"
#include "OpenAIApiImpl.h"
#include "OptimizeApiImpl.h"
#include "OrsonApiImpl.h"
#include "PackApiImpl.h"
#include "ParticipantsApiImpl.h"
#include "PathingApiImpl.h"
#include "PostalCodeApiImpl.h"
#include "PreviewPersonaApiImpl.h"
#include "ProgramApiImpl.h"
#include "PurchaseItemApiImpl.h"
#include "PurchaseOrderApiImpl.h"
#include "QuestionApiImpl.h"
#include "RankingApiImpl.h"
#include "RatingApiImpl.h"
#include "RegionApiImpl.h"
#include "ReportingApiImpl.h"
#include "ReservationApiImpl.h"
#include "RetailerApiImpl.h"
#include "RetailerLocationApiImpl.h"
#include "RetailerV2ApiImpl.h"
#include "RouteApiImpl.h"
#include "RouteSettingApiImpl.h"
#include "RoutingApiImpl.h"
#include "ScheduledNotificationApiImpl.h"
#include "ScoreApiImpl.h"
#include "SecureAppApiImpl.h"
#include "ServiceHubApiImpl.h"
#include "ShipmentApiImpl.h"
#include "ShipmentBatchApiImpl.h"
#include "SimulationApiImpl.h"
#include "StopApiImpl.h"
#include "StripeApiImpl.h"
#include "SubscriptionApiImpl.h"
#include "TaskApiImpl.h"
#include "TerritoryApiImpl.h"
#include "ThemeDescriptorApiImpl.h"
#include "ThirdPartyCredentialsApiImpl.h"
#include "TicketApiImpl.h"
#include "TournamentApiImpl.h"
#include "TrackingApiImpl.h"
#include "TriggerApiImpl.h"
#include "TripApiImpl.h"
#include "TwilioApiImpl.h"
#include "TwitterApiImpl.h"
#include "UserPermissionsApiImpl.h"
#include "VatomApiImpl.h"
#include "VehicleApiImpl.h"
#include "VehicleTypeApiImpl.h"
#include "WalletApiImpl.h"
#include "WeatherApiImpl.h"
#include "WordApiImpl.h"
#include "WorkflowApiImpl.h"

#define PISTACHE_SERVER_THREADS     2
#define PISTACHE_SERVER_MAX_REQUEST_SIZE 32768
#define PISTACHE_SERVER_MAX_RESPONSE_SIZE 32768

static Pistache::Http::Endpoint *httpEndpoint;
#ifdef __linux__
static void sigHandler [[noreturn]] (int sig){
    switch(sig){
        case SIGINT:
        case SIGQUIT:
        case SIGTERM:
        case SIGHUP:
        default:
            httpEndpoint->shutdown();
            break;
    }
    exit(0);
}

static void setUpUnixSignals(std::vector<int> quitSignals) {
    sigset_t blocking_mask;
    sigemptyset(&blocking_mask);
    for (auto sig : quitSignals)
        sigaddset(&blocking_mask, sig);

    struct sigaction sa;
    sa.sa_handler = sigHandler;
    sa.sa_mask    = blocking_mask;
    sa.sa_flags   = 0;

    for (auto sig : quitSignals)
        sigaction(sig, &sa, nullptr);
}
#endif

using namespace org::openapitools::server::api;

int main() {
#ifdef __linux__
    std::vector<int> sigs{SIGQUIT, SIGINT, SIGTERM, SIGHUP};
    setUpUnixSignals(sigs);
#endif
    Pistache::Address addr(Pistache::Ipv4::any(), Pistache::Port(8080));

    httpEndpoint = new Pistache::Http::Endpoint((addr));
    auto router = std::make_shared<Pistache::Rest::Router>();

    auto opts = Pistache::Http::Endpoint::options()
        .threads(PISTACHE_SERVER_THREADS);
    opts.flags(Pistache::Tcp::Options::ReuseAddr);
    opts.maxRequestSize(PISTACHE_SERVER_MAX_REQUEST_SIZE);
    opts.maxResponseSize(PISTACHE_SERVER_MAX_RESPONSE_SIZE);
    httpEndpoint->init(opts);

    auto apiImpls = std::vector<std::shared_ptr<ApiBase>>();
    
    apiImpls.push_back(std::make_shared<AMQPApiImpl>(router));
    apiImpls.push_back(std::make_shared<AccountApiImpl>(router));
    apiImpls.push_back(std::make_shared<AchievementApiImpl>(router));
    apiImpls.push_back(std::make_shared<ActivityApiImpl>(router));
    apiImpls.push_back(std::make_shared<AlbumApiImpl>(router));
    apiImpls.push_back(std::make_shared<AnalyticsApiImpl>(router));
    apiImpls.push_back(std::make_shared<AppDataApiImpl>(router));
    apiImpls.push_back(std::make_shared<ApplicationApiImpl>(router));
    apiImpls.push_back(std::make_shared<ApplicationConfigApiImpl>(router));
    apiImpls.push_back(std::make_shared<AssetApiImpl>(router));
    apiImpls.push_back(std::make_shared<AssignmentApiImpl>(router));
    apiImpls.push_back(std::make_shared<AudienceApiImpl>(router));
    apiImpls.push_back(std::make_shared<BidApiImpl>(router));
    apiImpls.push_back(std::make_shared<BillableEntityApiImpl>(router));
    apiImpls.push_back(std::make_shared<BillingInfoApiImpl>(router));
    apiImpls.push_back(std::make_shared<CSVImportApiImpl>(router));
    apiImpls.push_back(std::make_shared<CargoTypeApiImpl>(router));
    apiImpls.push_back(std::make_shared<CarrierApiImpl>(router));
    apiImpls.push_back(std::make_shared<CategoryApiImpl>(router));
    apiImpls.push_back(std::make_shared<ConnectionApiImpl>(router));
    apiImpls.push_back(std::make_shared<ContestApiImpl>(router));
    apiImpls.push_back(std::make_shared<CreativeApiImpl>(router));
    apiImpls.push_back(std::make_shared<DependentApiImpl>(router));
    apiImpls.push_back(std::make_shared<DisbursementApiImpl>(router));
    apiImpls.push_back(std::make_shared<EmployeeApiImpl>(router));
    apiImpls.push_back(std::make_shared<EventApiImpl>(router));
    apiImpls.push_back(std::make_shared<FacebookApiImpl>(router));
    apiImpls.push_back(std::make_shared<FavoriteApiImpl>(router));
    apiImpls.push_back(std::make_shared<FilterApiImpl>(router));
    apiImpls.push_back(std::make_shared<FlagApiImpl>(router));
    apiImpls.push_back(std::make_shared<GameApiImpl>(router));
    apiImpls.push_back(std::make_shared<GameLevelApiImpl>(router));
    apiImpls.push_back(std::make_shared<InviteApiImpl>(router));
    apiImpls.push_back(std::make_shared<LeaderboardApiImpl>(router));
    apiImpls.push_back(std::make_shared<LikeApiImpl>(router));
    apiImpls.push_back(std::make_shared<ListingApiImpl>(router));
    apiImpls.push_back(std::make_shared<LocationApiImpl>(router));
    apiImpls.push_back(std::make_shared<LocationApiV2ApiImpl>(router));
    apiImpls.push_back(std::make_shared<MediaApiImpl>(router));
    apiImpls.push_back(std::make_shared<MissionApiImpl>(router));
    apiImpls.push_back(std::make_shared<MissionInviteApiImpl>(router));
    apiImpls.push_back(std::make_shared<NoteApiImpl>(router));
    apiImpls.push_back(std::make_shared<NotificationApiImpl>(router));
    apiImpls.push_back(std::make_shared<ObjectStoreApiImpl>(router));
    apiImpls.push_back(std::make_shared<OfferApiImpl>(router));
    apiImpls.push_back(std::make_shared<OfferStatusApiImpl>(router));
    apiImpls.push_back(std::make_shared<OpenAIApiImpl>(router));
    apiImpls.push_back(std::make_shared<OptimizeApiImpl>(router));
    apiImpls.push_back(std::make_shared<OrsonApiImpl>(router));
    apiImpls.push_back(std::make_shared<PackApiImpl>(router));
    apiImpls.push_back(std::make_shared<ParticipantsApiImpl>(router));
    apiImpls.push_back(std::make_shared<PathingApiImpl>(router));
    apiImpls.push_back(std::make_shared<PostalCodeApiImpl>(router));
    apiImpls.push_back(std::make_shared<PreviewPersonaApiImpl>(router));
    apiImpls.push_back(std::make_shared<ProgramApiImpl>(router));
    apiImpls.push_back(std::make_shared<PurchaseItemApiImpl>(router));
    apiImpls.push_back(std::make_shared<PurchaseOrderApiImpl>(router));
    apiImpls.push_back(std::make_shared<QuestionApiImpl>(router));
    apiImpls.push_back(std::make_shared<RankingApiImpl>(router));
    apiImpls.push_back(std::make_shared<RatingApiImpl>(router));
    apiImpls.push_back(std::make_shared<RegionApiImpl>(router));
    apiImpls.push_back(std::make_shared<ReportingApiImpl>(router));
    apiImpls.push_back(std::make_shared<ReservationApiImpl>(router));
    apiImpls.push_back(std::make_shared<RetailerApiImpl>(router));
    apiImpls.push_back(std::make_shared<RetailerLocationApiImpl>(router));
    apiImpls.push_back(std::make_shared<RetailerV2ApiImpl>(router));
    apiImpls.push_back(std::make_shared<RouteApiImpl>(router));
    apiImpls.push_back(std::make_shared<RouteSettingApiImpl>(router));
    apiImpls.push_back(std::make_shared<RoutingApiImpl>(router));
    apiImpls.push_back(std::make_shared<ScheduledNotificationApiImpl>(router));
    apiImpls.push_back(std::make_shared<ScoreApiImpl>(router));
    apiImpls.push_back(std::make_shared<SecureAppApiImpl>(router));
    apiImpls.push_back(std::make_shared<ServiceHubApiImpl>(router));
    apiImpls.push_back(std::make_shared<ShipmentApiImpl>(router));
    apiImpls.push_back(std::make_shared<ShipmentBatchApiImpl>(router));
    apiImpls.push_back(std::make_shared<SimulationApiImpl>(router));
    apiImpls.push_back(std::make_shared<StopApiImpl>(router));
    apiImpls.push_back(std::make_shared<StripeApiImpl>(router));
    apiImpls.push_back(std::make_shared<SubscriptionApiImpl>(router));
    apiImpls.push_back(std::make_shared<TaskApiImpl>(router));
    apiImpls.push_back(std::make_shared<TerritoryApiImpl>(router));
    apiImpls.push_back(std::make_shared<ThemeDescriptorApiImpl>(router));
    apiImpls.push_back(std::make_shared<ThirdPartyCredentialsApiImpl>(router));
    apiImpls.push_back(std::make_shared<TicketApiImpl>(router));
    apiImpls.push_back(std::make_shared<TournamentApiImpl>(router));
    apiImpls.push_back(std::make_shared<TrackingApiImpl>(router));
    apiImpls.push_back(std::make_shared<TriggerApiImpl>(router));
    apiImpls.push_back(std::make_shared<TripApiImpl>(router));
    apiImpls.push_back(std::make_shared<TwilioApiImpl>(router));
    apiImpls.push_back(std::make_shared<TwitterApiImpl>(router));
    apiImpls.push_back(std::make_shared<UserPermissionsApiImpl>(router));
    apiImpls.push_back(std::make_shared<VatomApiImpl>(router));
    apiImpls.push_back(std::make_shared<VehicleApiImpl>(router));
    apiImpls.push_back(std::make_shared<VehicleTypeApiImpl>(router));
    apiImpls.push_back(std::make_shared<WalletApiImpl>(router));
    apiImpls.push_back(std::make_shared<WeatherApiImpl>(router));
    apiImpls.push_back(std::make_shared<WordApiImpl>(router));
    apiImpls.push_back(std::make_shared<WorkflowApiImpl>(router));

    for (auto api : apiImpls) {
        api->init();
    }

    httpEndpoint->setHandler(router->handler());
    httpEndpoint->serve();

    httpEndpoint->shutdown();
}
