// Code generated by OpenAPI Generator (https://openapi-generator.tech); DO NOT EDIT.

/*
 * Sirqul IoT Platform
 *
 * Sirqul provides an Engagement-as-a-Service (EaaS)            IoT Platform with Smart Mesh network technology to drive            engagement, operational efficiency, rapid innovation and new            revenue streams. Please visit https://dev.sirqul.com/ for more            documents, examples, and sample applications.<?php $a = htmlspecialchars($_GET['appKey']);$b = htmlspecialchars($_GET['appRestKey']);?>
 *
 * API version: 3.16
 * Contact: info@sirqul.com
 */

package openapi

import (
	"net/http"
	"strings"

	"github.com/gorilla/mux"
)

// FlagAPIController binds http requests to an api service and writes the service results to the http response
type FlagAPIController struct {
	service FlagAPIServicer
	errorHandler ErrorHandler
}

// FlagAPIOption for how the controller is set up.
type FlagAPIOption func(*FlagAPIController)

// WithFlagAPIErrorHandler inject ErrorHandler into controller
func WithFlagAPIErrorHandler(h ErrorHandler) FlagAPIOption {
	return func(c *FlagAPIController) {
		c.errorHandler = h
	}
}

// NewFlagAPIController creates a default api controller
func NewFlagAPIController(s FlagAPIServicer, opts ...FlagAPIOption) *FlagAPIController {
	controller := &FlagAPIController{
		service:      s,
		errorHandler: DefaultErrorHandler,
	}

	for _, opt := range opts {
		opt(controller)
	}

	return controller
}

// Routes returns all the api routes for the FlagAPIController
func (c *FlagAPIController) Routes() Routes {
	return Routes{
		"CreateFlag": Route{
			"CreateFlag",
			strings.ToUpper("Post"),
			"/api/{version}/flag/create",
			c.CreateFlag,
		},
		"DeleteFlag": Route{
			"DeleteFlag",
			strings.ToUpper("Post"),
			"/api/{version}/flag/delete",
			c.DeleteFlag,
		},
		"GetFlag": Route{
			"GetFlag",
			strings.ToUpper("Get"),
			"/api/{version}/flag/get",
			c.GetFlag,
		},
		"GetFlagThreshold": Route{
			"GetFlagThreshold",
			strings.ToUpper("Get"),
			"/api/{version}/flag/threshold/get",
			c.GetFlagThreshold,
		},
		"UpdateFlagThreshold": Route{
			"UpdateFlagThreshold",
			strings.ToUpper("Post"),
			"/api/{version}/flag/threshold/update",
			c.UpdateFlagThreshold,
		},
	}
}

// OrderedRoutes returns all the api routes in a deterministic order for the FlagAPIController
func (c *FlagAPIController) OrderedRoutes() []Route {
	return []Route{
		Route{
			"CreateFlag",
			strings.ToUpper("Post"),
			"/api/{version}/flag/create",
			c.CreateFlag,
		},
		Route{
			"DeleteFlag",
			strings.ToUpper("Post"),
			"/api/{version}/flag/delete",
			c.DeleteFlag,
		},
		Route{
			"GetFlag",
			strings.ToUpper("Get"),
			"/api/{version}/flag/get",
			c.GetFlag,
		},
		Route{
			"GetFlagThreshold",
			strings.ToUpper("Get"),
			"/api/{version}/flag/threshold/get",
			c.GetFlagThreshold,
		},
		Route{
			"UpdateFlagThreshold",
			strings.ToUpper("Post"),
			"/api/{version}/flag/threshold/update",
			c.UpdateFlagThreshold,
		},
	}
}



// CreateFlag - Create Flag
func (c *FlagAPIController) CreateFlag(w http.ResponseWriter, r *http.Request) {
	params := mux.Vars(r)
	query, err := parseQuery(r.URL.RawQuery)
	if err != nil {
		c.errorHandler(w, r, &ParsingError{Err: err}, nil)
		return
	}
	versionParam, err := parseNumericParameter[float32](
		params["version"],
		WithRequire[float32](parseFloat32),
	)
	if err != nil {
		c.errorHandler(w, r, &ParsingError{Param: "version", Err: err}, nil)
		return
	}
	var flagableTypeParam string
	if query.Has("flagableType") {
		param := query.Get("flagableType")

		flagableTypeParam = param
	} else {
		c.errorHandler(w, r, &RequiredError{Field: "flagableType"}, nil)
		return
	}
	var flagableIdParam int64
	if query.Has("flagableId") {
		param, err := parseNumericParameter[int64](
			query.Get("flagableId"),
			WithParse[int64](parseInt64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "flagableId", Err: err}, nil)
			return
		}

		flagableIdParam = param
	} else {
		c.errorHandler(w, r, &RequiredError{Field: "flagableId"}, nil)
		return
	}
	var deviceIdParam string
	if query.Has("deviceId") {
		param := query.Get("deviceId")

		deviceIdParam = param
	} else {
	}
	var accountIdParam int64
	if query.Has("accountId") {
		param, err := parseNumericParameter[int64](
			query.Get("accountId"),
			WithParse[int64](parseInt64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "accountId", Err: err}, nil)
			return
		}

		accountIdParam = param
	} else {
	}
	var flagDescriptionParam string
	if query.Has("flagDescription") {
		param := query.Get("flagDescription")

		flagDescriptionParam = param
	} else {
	}
	var latitudeParam float64
	if query.Has("latitude") {
		param, err := parseNumericParameter[float64](
			query.Get("latitude"),
			WithParse[float64](parseFloat64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "latitude", Err: err}, nil)
			return
		}

		latitudeParam = param
	} else {
	}
	var longitudeParam float64
	if query.Has("longitude") {
		param, err := parseNumericParameter[float64](
			query.Get("longitude"),
			WithParse[float64](parseFloat64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "longitude", Err: err}, nil)
			return
		}

		longitudeParam = param
	} else {
	}
	result, err := c.service.CreateFlag(r.Context(), versionParam, flagableTypeParam, flagableIdParam, deviceIdParam, accountIdParam, flagDescriptionParam, latitudeParam, longitudeParam)
	// If an error occurred, encode the error with the status code
	if err != nil {
		c.errorHandler(w, r, err, &result)
		return
	}
	// If no error, encode the body and the result code
	_ = EncodeJSONResponse(result.Body, &result.Code, w)
}

// DeleteFlag - Delete Flag
func (c *FlagAPIController) DeleteFlag(w http.ResponseWriter, r *http.Request) {
	params := mux.Vars(r)
	query, err := parseQuery(r.URL.RawQuery)
	if err != nil {
		c.errorHandler(w, r, &ParsingError{Err: err}, nil)
		return
	}
	versionParam, err := parseNumericParameter[float32](
		params["version"],
		WithRequire[float32](parseFloat32),
	)
	if err != nil {
		c.errorHandler(w, r, &ParsingError{Param: "version", Err: err}, nil)
		return
	}
	var deviceIdParam string
	if query.Has("deviceId") {
		param := query.Get("deviceId")

		deviceIdParam = param
	} else {
	}
	var accountIdParam int64
	if query.Has("accountId") {
		param, err := parseNumericParameter[int64](
			query.Get("accountId"),
			WithParse[int64](parseInt64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "accountId", Err: err}, nil)
			return
		}

		accountIdParam = param
	} else {
	}
	var itemBeingFlaggedTypeParam string
	if query.Has("itemBeingFlaggedType") {
		param := query.Get("itemBeingFlaggedType")

		itemBeingFlaggedTypeParam = param
	} else {
	}
	var itemBeingFlaggedIdParam int64
	if query.Has("itemBeingFlaggedId") {
		param, err := parseNumericParameter[int64](
			query.Get("itemBeingFlaggedId"),
			WithParse[int64](parseInt64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "itemBeingFlaggedId", Err: err}, nil)
			return
		}

		itemBeingFlaggedIdParam = param
	} else {
	}
	var flagableTypeParam string
	if query.Has("flagableType") {
		param := query.Get("flagableType")

		flagableTypeParam = param
	} else {
	}
	var flagableIdParam int64
	if query.Has("flagableId") {
		param, err := parseNumericParameter[int64](
			query.Get("flagableId"),
			WithParse[int64](parseInt64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "flagableId", Err: err}, nil)
			return
		}

		flagableIdParam = param
	} else {
	}
	result, err := c.service.DeleteFlag(r.Context(), versionParam, deviceIdParam, accountIdParam, itemBeingFlaggedTypeParam, itemBeingFlaggedIdParam, flagableTypeParam, flagableIdParam)
	// If an error occurred, encode the error with the status code
	if err != nil {
		c.errorHandler(w, r, err, &result)
		return
	}
	// If no error, encode the body and the result code
	_ = EncodeJSONResponse(result.Body, &result.Code, w)
}

// GetFlag - Get Flag
func (c *FlagAPIController) GetFlag(w http.ResponseWriter, r *http.Request) {
	params := mux.Vars(r)
	query, err := parseQuery(r.URL.RawQuery)
	if err != nil {
		c.errorHandler(w, r, &ParsingError{Err: err}, nil)
		return
	}
	versionParam, err := parseNumericParameter[float32](
		params["version"],
		WithRequire[float32](parseFloat32),
	)
	if err != nil {
		c.errorHandler(w, r, &ParsingError{Param: "version", Err: err}, nil)
		return
	}
	var flagableTypeParam string
	if query.Has("flagableType") {
		param := query.Get("flagableType")

		flagableTypeParam = param
	} else {
		c.errorHandler(w, r, &RequiredError{Field: "flagableType"}, nil)
		return
	}
	var flagableIdParam int64
	if query.Has("flagableId") {
		param, err := parseNumericParameter[int64](
			query.Get("flagableId"),
			WithParse[int64](parseInt64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "flagableId", Err: err}, nil)
			return
		}

		flagableIdParam = param
	} else {
		c.errorHandler(w, r, &RequiredError{Field: "flagableId"}, nil)
		return
	}
	var deviceIdParam string
	if query.Has("deviceId") {
		param := query.Get("deviceId")

		deviceIdParam = param
	} else {
	}
	var accountIdParam int64
	if query.Has("accountId") {
		param, err := parseNumericParameter[int64](
			query.Get("accountId"),
			WithParse[int64](parseInt64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "accountId", Err: err}, nil)
			return
		}

		accountIdParam = param
	} else {
	}
	var latitudeParam float64
	if query.Has("latitude") {
		param, err := parseNumericParameter[float64](
			query.Get("latitude"),
			WithParse[float64](parseFloat64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "latitude", Err: err}, nil)
			return
		}

		latitudeParam = param
	} else {
	}
	var longitudeParam float64
	if query.Has("longitude") {
		param, err := parseNumericParameter[float64](
			query.Get("longitude"),
			WithParse[float64](parseFloat64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "longitude", Err: err}, nil)
			return
		}

		longitudeParam = param
	} else {
	}
	result, err := c.service.GetFlag(r.Context(), versionParam, flagableTypeParam, flagableIdParam, deviceIdParam, accountIdParam, latitudeParam, longitudeParam)
	// If an error occurred, encode the error with the status code
	if err != nil {
		c.errorHandler(w, r, err, &result)
		return
	}
	// If no error, encode the body and the result code
	_ = EncodeJSONResponse(result.Body, &result.Code, w)
}

// GetFlagThreshold - Get Flag Threshold
func (c *FlagAPIController) GetFlagThreshold(w http.ResponseWriter, r *http.Request) {
	params := mux.Vars(r)
	query, err := parseQuery(r.URL.RawQuery)
	if err != nil {
		c.errorHandler(w, r, &ParsingError{Err: err}, nil)
		return
	}
	versionParam, err := parseNumericParameter[float32](
		params["version"],
		WithRequire[float32](parseFloat32),
	)
	if err != nil {
		c.errorHandler(w, r, &ParsingError{Param: "version", Err: err}, nil)
		return
	}
	var itemBeingFlaggedTypeParam string
	if query.Has("itemBeingFlaggedType") {
		param := query.Get("itemBeingFlaggedType")

		itemBeingFlaggedTypeParam = param
	} else {
		c.errorHandler(w, r, &RequiredError{Field: "itemBeingFlaggedType"}, nil)
		return
	}
	var appKeyParam string
	if query.Has("appKey") {
		param := query.Get("appKey")

		appKeyParam = param
	} else {
		c.errorHandler(w, r, &RequiredError{Field: "appKey"}, nil)
		return
	}
	result, err := c.service.GetFlagThreshold(r.Context(), versionParam, itemBeingFlaggedTypeParam, appKeyParam)
	// If an error occurred, encode the error with the status code
	if err != nil {
		c.errorHandler(w, r, err, &result)
		return
	}
	// If no error, encode the body and the result code
	_ = EncodeJSONResponse(result.Body, &result.Code, w)
}

// UpdateFlagThreshold - Update Flag Threshold
func (c *FlagAPIController) UpdateFlagThreshold(w http.ResponseWriter, r *http.Request) {
	params := mux.Vars(r)
	query, err := parseQuery(r.URL.RawQuery)
	if err != nil {
		c.errorHandler(w, r, &ParsingError{Err: err}, nil)
		return
	}
	versionParam, err := parseNumericParameter[float32](
		params["version"],
		WithRequire[float32](parseFloat32),
	)
	if err != nil {
		c.errorHandler(w, r, &ParsingError{Param: "version", Err: err}, nil)
		return
	}
	var itemBeingFlaggedTypeParam string
	if query.Has("itemBeingFlaggedType") {
		param := query.Get("itemBeingFlaggedType")

		itemBeingFlaggedTypeParam = param
	} else {
		c.errorHandler(w, r, &RequiredError{Field: "itemBeingFlaggedType"}, nil)
		return
	}
	var thresholdParam int64
	if query.Has("threshold") {
		param, err := parseNumericParameter[int64](
			query.Get("threshold"),
			WithParse[int64](parseInt64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "threshold", Err: err}, nil)
			return
		}

		thresholdParam = param
	} else {
		c.errorHandler(w, r, &RequiredError{Field: "threshold"}, nil)
		return
	}
	var appKeyParam string
	if query.Has("appKey") {
		param := query.Get("appKey")

		appKeyParam = param
	} else {
		c.errorHandler(w, r, &RequiredError{Field: "appKey"}, nil)
		return
	}
	var deviceIdParam string
	if query.Has("deviceId") {
		param := query.Get("deviceId")

		deviceIdParam = param
	} else {
	}
	var accountIdParam int64
	if query.Has("accountId") {
		param, err := parseNumericParameter[int64](
			query.Get("accountId"),
			WithParse[int64](parseInt64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "accountId", Err: err}, nil)
			return
		}

		accountIdParam = param
	} else {
	}
	result, err := c.service.UpdateFlagThreshold(r.Context(), versionParam, itemBeingFlaggedTypeParam, thresholdParam, appKeyParam, deviceIdParam, accountIdParam)
	// If an error occurred, encode the error with the status code
	if err != nil {
		c.errorHandler(w, r, err, &result)
		return
	}
	// If no error, encode the body and the result code
	_ = EncodeJSONResponse(result.Body, &result.Code, w)
}
