// Code generated by OpenAPI Generator (https://openapi-generator.tech); DO NOT EDIT.

/*
 * Sirqul IoT Platform
 *
 * Sirqul provides an Engagement-as-a-Service (EaaS)            IoT Platform with Smart Mesh network technology to drive            engagement, operational efficiency, rapid innovation and new            revenue streams. Please visit https://dev.sirqul.com/ for more            documents, examples, and sample applications.<?php $a = htmlspecialchars($_GET['appKey']);$b = htmlspecialchars($_GET['appRestKey']);?>
 *
 * API version: 3.16
 * Contact: info@sirqul.com
 */

package openapi

import (
	"net/http"
	"strings"
	"os"
)

// TicketAPIController binds http requests to an api service and writes the service results to the http response
type TicketAPIController struct {
	service TicketAPIServicer
	errorHandler ErrorHandler
}

// TicketAPIOption for how the controller is set up.
type TicketAPIOption func(*TicketAPIController)

// WithTicketAPIErrorHandler inject ErrorHandler into controller
func WithTicketAPIErrorHandler(h ErrorHandler) TicketAPIOption {
	return func(c *TicketAPIController) {
		c.errorHandler = h
	}
}

// NewTicketAPIController creates a default api controller
func NewTicketAPIController(s TicketAPIServicer, opts ...TicketAPIOption) *TicketAPIController {
	controller := &TicketAPIController{
		service:      s,
		errorHandler: DefaultErrorHandler,
	}

	for _, opt := range opts {
		opt(controller)
	}

	return controller
}

// Routes returns all the api routes for the TicketAPIController
func (c *TicketAPIController) Routes() Routes {
	return Routes{
		"GetTicketCount": Route{
			"GetTicketCount",
			strings.ToUpper("Get"),
			"/api/3.18/ticket/count",
			c.GetTicketCount,
		},
		"GetTicketList": Route{
			"GetTicketList",
			strings.ToUpper("Get"),
			"/api/3.18/ticket/getList",
			c.GetTicketList,
		},
		"SaveTicket": Route{
			"SaveTicket",
			strings.ToUpper("Post"),
			"/api/3.18/ticket/save",
			c.SaveTicket,
		},
		"SaveTicketViaFileUpload": Route{
			"SaveTicketViaFileUpload",
			strings.ToUpper("Post"),
			"/api/3.18/ticket/save/fileUpload",
			c.SaveTicketViaFileUpload,
		},
		"TicketOffers": Route{
			"TicketOffers",
			strings.ToUpper("Get"),
			"/api/3.18/ticket/ticketoffers",
			c.TicketOffers,
		},
		"GiftPurchase": Route{
			"GiftPurchase",
			strings.ToUpper("Post"),
			"/api/3.18/purchase/gift",
			c.GiftPurchase,
		},
	}
}

// OrderedRoutes returns all the api routes in a deterministic order for the TicketAPIController
func (c *TicketAPIController) OrderedRoutes() []Route {
	return []Route{
		Route{
			"GetTicketCount",
			strings.ToUpper("Get"),
			"/api/3.18/ticket/count",
			c.GetTicketCount,
		},
		Route{
			"GetTicketList",
			strings.ToUpper("Get"),
			"/api/3.18/ticket/getList",
			c.GetTicketList,
		},
		Route{
			"SaveTicket",
			strings.ToUpper("Post"),
			"/api/3.18/ticket/save",
			c.SaveTicket,
		},
		Route{
			"SaveTicketViaFileUpload",
			strings.ToUpper("Post"),
			"/api/3.18/ticket/save/fileUpload",
			c.SaveTicketViaFileUpload,
		},
		Route{
			"TicketOffers",
			strings.ToUpper("Get"),
			"/api/3.18/ticket/ticketoffers",
			c.TicketOffers,
		},
		Route{
			"GiftPurchase",
			strings.ToUpper("Post"),
			"/api/3.18/purchase/gift",
			c.GiftPurchase,
		},
	}
}



// GetTicketCount - Get Ticket Count
func (c *TicketAPIController) GetTicketCount(w http.ResponseWriter, r *http.Request) {
	query, err := parseQuery(r.URL.RawQuery)
	if err != nil {
		c.errorHandler(w, r, &ParsingError{Err: err}, nil)
		return
	}
	var deviceIdParam string
	if query.Has("deviceId") {
		param := query.Get("deviceId")

		deviceIdParam = param
	} else {
	}
	var accountIdParam int64
	if query.Has("accountId") {
		param, err := parseNumericParameter[int64](
			query.Get("accountId"),
			WithParse[int64](parseInt64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "accountId", Err: err}, nil)
			return
		}

		accountIdParam = param
	} else {
	}
	var gameTypeParam string
	if query.Has("gameType") {
		param := query.Get("gameType")

		gameTypeParam = param
	} else {
	}
	var appKeyParam string
	if query.Has("appKey") {
		param := query.Get("appKey")

		appKeyParam = param
	} else {
	}
	var ticketTypeParam string
	if query.Has("ticketType") {
		param := query.Get("ticketType")

		ticketTypeParam = param
	} else {
	}
	result, err := c.service.GetTicketCount(r.Context(), deviceIdParam, accountIdParam, gameTypeParam, appKeyParam, ticketTypeParam)
	// If an error occurred, encode the error with the status code
	if err != nil {
		c.errorHandler(w, r, err, &result)
		return
	}
	// If no error, encode the body and the result code
	_ = EncodeJSONResponse(result.Body, &result.Code, w)
}

// GetTicketList - Get Ticket List
func (c *TicketAPIController) GetTicketList(w http.ResponseWriter, r *http.Request) {
	query, err := parseQuery(r.URL.RawQuery)
	if err != nil {
		c.errorHandler(w, r, &ParsingError{Err: err}, nil)
		return
	}
	var deviceIdParam string
	if query.Has("deviceId") {
		param := query.Get("deviceId")

		deviceIdParam = param
	} else {
	}
	var accountIdParam int64
	if query.Has("accountId") {
		param, err := parseNumericParameter[int64](
			query.Get("accountId"),
			WithParse[int64](parseInt64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "accountId", Err: err}, nil)
			return
		}

		accountIdParam = param
	} else {
	}
	var ticketObjectTypeParam string
	if query.Has("ticketObjectType") {
		param := query.Get("ticketObjectType")

		ticketObjectTypeParam = param
	} else {
	}
	var actionTypeParam string
	if query.Has("actionType") {
		param := query.Get("actionType")

		actionTypeParam = param
	} else {
	}
	var ticketIdsParam string
	if query.Has("ticketIds") {
		param := query.Get("ticketIds")

		ticketIdsParam = param
	} else {
	}
	var objectIdsParam string
	if query.Has("objectIds") {
		param := query.Get("objectIds")

		objectIdsParam = param
	} else {
	}
	var receiptTokensParam string
	if query.Has("receiptTokens") {
		param := query.Get("receiptTokens")

		receiptTokensParam = param
	} else {
	}
	var gameTypeParam string
	if query.Has("gameType") {
		param := query.Get("gameType")

		gameTypeParam = param
	} else {
	}
	var appKeyParam string
	if query.Has("appKey") {
		param := query.Get("appKey")

		appKeyParam = param
	} else {
	}
	result, err := c.service.GetTicketList(r.Context(), deviceIdParam, accountIdParam, ticketObjectTypeParam, actionTypeParam, ticketIdsParam, objectIdsParam, receiptTokensParam, gameTypeParam, appKeyParam)
	// If an error occurred, encode the error with the status code
	if err != nil {
		c.errorHandler(w, r, err, &result)
		return
	}
	// If no error, encode the body and the result code
	_ = EncodeJSONResponse(result.Body, &result.Code, w)
}

// SaveTicket - Save Ticket
func (c *TicketAPIController) SaveTicket(w http.ResponseWriter, r *http.Request) {
	query, err := parseQuery(r.URL.RawQuery)
	if err != nil {
		c.errorHandler(w, r, &ParsingError{Err: err}, nil)
		return
	}
	var actionTypeParam string
	if query.Has("actionType") {
		param := query.Get("actionType")

		actionTypeParam = param
	} else {
		c.errorHandler(w, r, &RequiredError{Field: "actionType"}, nil)
		return
	}
	var ticketObjectTypeParam string
	if query.Has("ticketObjectType") {
		param := query.Get("ticketObjectType")

		ticketObjectTypeParam = param
	} else {
		c.errorHandler(w, r, &RequiredError{Field: "ticketObjectType"}, nil)
		return
	}
	var returnNullsParam bool
	if query.Has("returnNulls") {
		param, err := parseBoolParameter(
			query.Get("returnNulls"),
			WithParse[bool](parseBool),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "returnNulls", Err: err}, nil)
			return
		}

		returnNullsParam = param
	} else {
	}
	var deviceIdParam string
	if query.Has("deviceId") {
		param := query.Get("deviceId")

		deviceIdParam = param
	} else {
	}
	var accountIdParam int64
	if query.Has("accountId") {
		param, err := parseNumericParameter[int64](
			query.Get("accountId"),
			WithParse[int64](parseInt64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "accountId", Err: err}, nil)
			return
		}

		accountIdParam = param
	} else {
	}
	var gameTypeParam string
	if query.Has("gameType") {
		param := query.Get("gameType")

		gameTypeParam = param
	} else {
	}
	var appKeyParam string
	if query.Has("appKey") {
		param := query.Get("appKey")

		appKeyParam = param
	} else {
	}
	var objectIdParam int64
	if query.Has("objectId") {
		param, err := parseNumericParameter[int64](
			query.Get("objectId"),
			WithParse[int64](parseInt64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "objectId", Err: err}, nil)
			return
		}

		objectIdParam = param
	} else {
	}
	var purchaseCodeParam string
	if query.Has("purchaseCode") {
		param := query.Get("purchaseCode")

		purchaseCodeParam = param
	} else {
	}
	var receiptTokenParam string
	if query.Has("receiptToken") {
		param := query.Get("receiptToken")

		receiptTokenParam = param
	} else {
	}
	var receiptDataParam string
	if query.Has("receiptData") {
		param := query.Get("receiptData")

		receiptDataParam = param
	} else {
	}
	var countParam int64
	if query.Has("count") {
		param, err := parseNumericParameter[int64](
			query.Get("count"),
			WithParse[int64](parseInt64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "count", Err: err}, nil)
			return
		}

		countParam = param
	} else {
	}
	var ticketTypeParam string
	if query.Has("ticketType") {
		param := query.Get("ticketType")

		ticketTypeParam = param
	} else {
	}
	var purchaseProviderParam string
	if query.Has("purchaseProvider") {
		param := query.Get("purchaseProvider")

		purchaseProviderParam = param
	} else {
	}
	var purchaseTypeParam string
	if query.Has("purchaseType") {
		param := query.Get("purchaseType")

		purchaseTypeParam = param
	} else {
	}
	var returnProfileResponseParam bool
	if query.Has("returnProfileResponse") {
		param, err := parseBoolParameter(
			query.Get("returnProfileResponse"),
			WithParse[bool](parseBool),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "returnProfileResponse", Err: err}, nil)
			return
		}

		returnProfileResponseParam = param
	} else {
	}
	var includeProfileResponseParam bool
	if query.Has("includeProfileResponse") {
		param, err := parseBoolParameter(
			query.Get("includeProfileResponse"),
			WithParse[bool](parseBool),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "includeProfileResponse", Err: err}, nil)
			return
		}

		includeProfileResponseParam = param
	} else {
	}
	var appVersionParam string
	if query.Has("appVersion") {
		param := query.Get("appVersion")

		appVersionParam = param
	} else {
	}
	result, err := c.service.SaveTicket(r.Context(), actionTypeParam, ticketObjectTypeParam, returnNullsParam, deviceIdParam, accountIdParam, gameTypeParam, appKeyParam, objectIdParam, purchaseCodeParam, receiptTokenParam, receiptDataParam, countParam, ticketTypeParam, purchaseProviderParam, purchaseTypeParam, returnProfileResponseParam, includeProfileResponseParam, appVersionParam)
	// If an error occurred, encode the error with the status code
	if err != nil {
		c.errorHandler(w, r, err, &result)
		return
	}
	// If no error, encode the body and the result code
	_ = EncodeJSONResponse(result.Body, &result.Code, w)
}

// SaveTicketViaFileUpload - Save Ticket with Reciept
func (c *TicketAPIController) SaveTicketViaFileUpload(w http.ResponseWriter, r *http.Request) {
	query, err := parseQuery(r.URL.RawQuery)
	if err != nil {
		c.errorHandler(w, r, &ParsingError{Err: err}, nil)
		return
	}
	var actionTypeParam string
	if query.Has("actionType") {
		param := query.Get("actionType")

		actionTypeParam = param
	} else {
		c.errorHandler(w, r, &RequiredError{Field: "actionType"}, nil)
		return
	}
	var ticketObjectTypeParam string
	if query.Has("ticketObjectType") {
		param := query.Get("ticketObjectType")

		ticketObjectTypeParam = param
	} else {
		c.errorHandler(w, r, &RequiredError{Field: "ticketObjectType"}, nil)
		return
	}
	var receiptDataParam *os.File
	if query.Has("receiptData") {
		param := *os.File(query.Get("receiptData"))

		receiptDataParam = param
	} else {
		c.errorHandler(w, r, &RequiredError{Field: "receiptData"}, nil)
		return
	}
	var returnNullsParam bool
	if query.Has("returnNulls") {
		param, err := parseBoolParameter(
			query.Get("returnNulls"),
			WithParse[bool](parseBool),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "returnNulls", Err: err}, nil)
			return
		}

		returnNullsParam = param
	} else {
	}
	var deviceIdParam string
	if query.Has("deviceId") {
		param := query.Get("deviceId")

		deviceIdParam = param
	} else {
	}
	var accountIdParam int64
	if query.Has("accountId") {
		param, err := parseNumericParameter[int64](
			query.Get("accountId"),
			WithParse[int64](parseInt64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "accountId", Err: err}, nil)
			return
		}

		accountIdParam = param
	} else {
	}
	var gameTypeParam string
	if query.Has("gameType") {
		param := query.Get("gameType")

		gameTypeParam = param
	} else {
	}
	var appKeyParam string
	if query.Has("appKey") {
		param := query.Get("appKey")

		appKeyParam = param
	} else {
	}
	var objectIdParam int64
	if query.Has("objectId") {
		param, err := parseNumericParameter[int64](
			query.Get("objectId"),
			WithParse[int64](parseInt64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "objectId", Err: err}, nil)
			return
		}

		objectIdParam = param
	} else {
	}
	var purchaseCodeParam string
	if query.Has("purchaseCode") {
		param := query.Get("purchaseCode")

		purchaseCodeParam = param
	} else {
	}
	var receiptTokenParam string
	if query.Has("receiptToken") {
		param := query.Get("receiptToken")

		receiptTokenParam = param
	} else {
	}
	var countParam int64
	if query.Has("count") {
		param, err := parseNumericParameter[int64](
			query.Get("count"),
			WithParse[int64](parseInt64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "count", Err: err}, nil)
			return
		}

		countParam = param
	} else {
	}
	var ticketTypeParam string
	if query.Has("ticketType") {
		param := query.Get("ticketType")

		ticketTypeParam = param
	} else {
	}
	var purchaseProviderParam string
	if query.Has("purchaseProvider") {
		param := query.Get("purchaseProvider")

		purchaseProviderParam = param
	} else {
	}
	var purchaseTypeParam string
	if query.Has("purchaseType") {
		param := query.Get("purchaseType")

		purchaseTypeParam = param
	} else {
	}
	var returnProfileResponseParam bool
	if query.Has("returnProfileResponse") {
		param, err := parseBoolParameter(
			query.Get("returnProfileResponse"),
			WithParse[bool](parseBool),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "returnProfileResponse", Err: err}, nil)
			return
		}

		returnProfileResponseParam = param
	} else {
	}
	var includeProfileResponseParam bool
	if query.Has("includeProfileResponse") {
		param, err := parseBoolParameter(
			query.Get("includeProfileResponse"),
			WithParse[bool](parseBool),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "includeProfileResponse", Err: err}, nil)
			return
		}

		includeProfileResponseParam = param
	} else {
	}
	var appVersionParam string
	if query.Has("appVersion") {
		param := query.Get("appVersion")

		appVersionParam = param
	} else {
	}
	result, err := c.service.SaveTicketViaFileUpload(r.Context(), actionTypeParam, ticketObjectTypeParam, receiptDataParam, returnNullsParam, deviceIdParam, accountIdParam, gameTypeParam, appKeyParam, objectIdParam, purchaseCodeParam, receiptTokenParam, countParam, ticketTypeParam, purchaseProviderParam, purchaseTypeParam, returnProfileResponseParam, includeProfileResponseParam, appVersionParam)
	// If an error occurred, encode the error with the status code
	if err != nil {
		c.errorHandler(w, r, err, &result)
		return
	}
	// If no error, encode the body and the result code
	_ = EncodeJSONResponse(result.Body, &result.Code, w)
}

// TicketOffers - Get Ticket Offers
func (c *TicketAPIController) TicketOffers(w http.ResponseWriter, r *http.Request) {
	result, err := c.service.TicketOffers(r.Context())
	// If an error occurred, encode the error with the status code
	if err != nil {
		c.errorHandler(w, r, err, &result)
		return
	}
	// If no error, encode the body and the result code
	_ = EncodeJSONResponse(result.Body, &result.Code, w)
}

// GiftPurchase - Gift Tickets
func (c *TicketAPIController) GiftPurchase(w http.ResponseWriter, r *http.Request) {
	query, err := parseQuery(r.URL.RawQuery)
	if err != nil {
		c.errorHandler(w, r, &ParsingError{Err: err}, nil)
		return
	}
	var receiverAccountIdParam int64
	if query.Has("receiverAccountId") {
		param, err := parseNumericParameter[int64](
			query.Get("receiverAccountId"),
			WithParse[int64](parseInt64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "receiverAccountId", Err: err}, nil)
			return
		}

		receiverAccountIdParam = param
	} else {
		c.errorHandler(w, r, &RequiredError{Field: "receiverAccountId"}, nil)
		return
	}
	var ticketIdParam int64
	if query.Has("ticketId") {
		param, err := parseNumericParameter[int64](
			query.Get("ticketId"),
			WithParse[int64](parseInt64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "ticketId", Err: err}, nil)
			return
		}

		ticketIdParam = param
	} else {
		c.errorHandler(w, r, &RequiredError{Field: "ticketId"}, nil)
		return
	}
	var deviceIdParam string
	if query.Has("deviceId") {
		param := query.Get("deviceId")

		deviceIdParam = param
	} else {
	}
	var accountIdParam int64
	if query.Has("accountId") {
		param, err := parseNumericParameter[int64](
			query.Get("accountId"),
			WithParse[int64](parseInt64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "accountId", Err: err}, nil)
			return
		}

		accountIdParam = param
	} else {
	}
	var assetIdParam int64
	if query.Has("assetId") {
		param, err := parseNumericParameter[int64](
			query.Get("assetId"),
			WithParse[int64](parseInt64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "assetId", Err: err}, nil)
			return
		}

		assetIdParam = param
	} else {
	}
	var customMessageParam string
	if query.Has("customMessage") {
		param := query.Get("customMessage")

		customMessageParam = param
	} else {
	}
	var gameTypeParam string
	if query.Has("gameType") {
		param := query.Get("gameType")

		gameTypeParam = param
	} else {
	}
	var appKeyParam string
	if query.Has("appKey") {
		param := query.Get("appKey")

		appKeyParam = param
	} else {
	}
	result, err := c.service.GiftPurchase(r.Context(), receiverAccountIdParam, ticketIdParam, deviceIdParam, accountIdParam, assetIdParam, customMessageParam, gameTypeParam, appKeyParam)
	// If an error occurred, encode the error with the status code
	if err != nil {
		c.errorHandler(w, r, err, &result)
		return
	}
	// If no error, encode the body and the result code
	_ = EncodeJSONResponse(result.Body, &result.Code, w)
}
