// Code generated by OpenAPI Generator (https://openapi-generator.tech); DO NOT EDIT.

/*
 * Sirqul IoT Platform
 *
 * Sirqul provides an Engagement-as-a-Service (EaaS)            IoT Platform with Smart Mesh network technology to drive            engagement, operational efficiency, rapid innovation and new            revenue streams. Please visit https://dev.sirqul.com/ for more            documents, examples, and sample applications.<?php $a = htmlspecialchars($_GET['appKey']);$b = htmlspecialchars($_GET['appRestKey']);?>
 *
 * API version: 3.16
 * Contact: info@sirqul.com
 */

package openapi

import (
	"net/http"
	"strings"
)

// PreviewPersonaAPIController binds http requests to an api service and writes the service results to the http response
type PreviewPersonaAPIController struct {
	service PreviewPersonaAPIServicer
	errorHandler ErrorHandler
}

// PreviewPersonaAPIOption for how the controller is set up.
type PreviewPersonaAPIOption func(*PreviewPersonaAPIController)

// WithPreviewPersonaAPIErrorHandler inject ErrorHandler into controller
func WithPreviewPersonaAPIErrorHandler(h ErrorHandler) PreviewPersonaAPIOption {
	return func(c *PreviewPersonaAPIController) {
		c.errorHandler = h
	}
}

// NewPreviewPersonaAPIController creates a default api controller
func NewPreviewPersonaAPIController(s PreviewPersonaAPIServicer, opts ...PreviewPersonaAPIOption) *PreviewPersonaAPIController {
	controller := &PreviewPersonaAPIController{
		service:      s,
		errorHandler: DefaultErrorHandler,
	}

	for _, opt := range opts {
		opt(controller)
	}

	return controller
}

// Routes returns all the api routes for the PreviewPersonaAPIController
func (c *PreviewPersonaAPIController) Routes() Routes {
	return Routes{
		"CreatePersona": Route{
			"CreatePersona",
			strings.ToUpper("Post"),
			"/api/3.18/persona/create",
			c.CreatePersona,
		},
		"DeletePersona": Route{
			"DeletePersona",
			strings.ToUpper("Post"),
			"/api/3.18/persona/delete",
			c.DeletePersona,
		},
		"GetPersonaList": Route{
			"GetPersonaList",
			strings.ToUpper("Get"),
			"/api/3.18/persona/get",
			c.GetPersonaList,
		},
		"SearchPersona": Route{
			"SearchPersona",
			strings.ToUpper("Get"),
			"/api/3.18/persona/search",
			c.SearchPersona,
		},
		"UpdatePersona": Route{
			"UpdatePersona",
			strings.ToUpper("Post"),
			"/api/3.18/persona/update",
			c.UpdatePersona,
		},
	}
}

// OrderedRoutes returns all the api routes in a deterministic order for the PreviewPersonaAPIController
func (c *PreviewPersonaAPIController) OrderedRoutes() []Route {
	return []Route{
		Route{
			"CreatePersona",
			strings.ToUpper("Post"),
			"/api/3.18/persona/create",
			c.CreatePersona,
		},
		Route{
			"DeletePersona",
			strings.ToUpper("Post"),
			"/api/3.18/persona/delete",
			c.DeletePersona,
		},
		Route{
			"GetPersonaList",
			strings.ToUpper("Get"),
			"/api/3.18/persona/get",
			c.GetPersonaList,
		},
		Route{
			"SearchPersona",
			strings.ToUpper("Get"),
			"/api/3.18/persona/search",
			c.SearchPersona,
		},
		Route{
			"UpdatePersona",
			strings.ToUpper("Post"),
			"/api/3.18/persona/update",
			c.UpdatePersona,
		},
	}
}



// CreatePersona - Create Persona
func (c *PreviewPersonaAPIController) CreatePersona(w http.ResponseWriter, r *http.Request) {
	query, err := parseQuery(r.URL.RawQuery)
	if err != nil {
		c.errorHandler(w, r, &ParsingError{Err: err}, nil)
		return
	}
	var accountIdParam int64
	if query.Has("accountId") {
		param, err := parseNumericParameter[int64](
			query.Get("accountId"),
			WithParse[int64](parseInt64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "accountId", Err: err}, nil)
			return
		}

		accountIdParam = param
	} else {
		c.errorHandler(w, r, &RequiredError{Field: "accountId"}, nil)
		return
	}
	var titleParam string
	if query.Has("title") {
		param := query.Get("title")

		titleParam = param
	} else {
		c.errorHandler(w, r, &RequiredError{Field: "title"}, nil)
		return
	}
	var previewAccountsParam string
	if query.Has("previewAccounts") {
		param := query.Get("previewAccounts")

		previewAccountsParam = param
	} else {
	}
	var dateParam int64
	if query.Has("date") {
		param, err := parseNumericParameter[int64](
			query.Get("date"),
			WithParse[int64](parseInt64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "date", Err: err}, nil)
			return
		}

		dateParam = param
	} else {
	}
	var ageParam int32
	if query.Has("age") {
		param, err := parseNumericParameter[int32](
			query.Get("age"),
			WithParse[int32](parseInt32),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "age", Err: err}, nil)
			return
		}

		ageParam = param
	} else {
	}
	var genderParam string
	if query.Has("gender") {
		param := query.Get("gender")

		genderParam = param
	} else {
	}
	var gameExperienceLevelParam string
	if query.Has("gameExperienceLevel") {
		param := query.Get("gameExperienceLevel")

		gameExperienceLevelParam = param
	} else {
	}
	var latitudeParam float64
	if query.Has("latitude") {
		param, err := parseNumericParameter[float64](
			query.Get("latitude"),
			WithParse[float64](parseFloat64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "latitude", Err: err}, nil)
			return
		}

		latitudeParam = param
	} else {
	}
	var longitudeParam float64
	if query.Has("longitude") {
		param, err := parseNumericParameter[float64](
			query.Get("longitude"),
			WithParse[float64](parseFloat64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "longitude", Err: err}, nil)
			return
		}

		longitudeParam = param
	} else {
	}
	result, err := c.service.CreatePersona(r.Context(), accountIdParam, titleParam, previewAccountsParam, dateParam, ageParam, genderParam, gameExperienceLevelParam, latitudeParam, longitudeParam)
	// If an error occurred, encode the error with the status code
	if err != nil {
		c.errorHandler(w, r, err, &result)
		return
	}
	// If no error, encode the body and the result code
	_ = EncodeJSONResponse(result.Body, &result.Code, w)
}

// DeletePersona - Delete Persona
func (c *PreviewPersonaAPIController) DeletePersona(w http.ResponseWriter, r *http.Request) {
	query, err := parseQuery(r.URL.RawQuery)
	if err != nil {
		c.errorHandler(w, r, &ParsingError{Err: err}, nil)
		return
	}
	var accountIdParam int64
	if query.Has("accountId") {
		param, err := parseNumericParameter[int64](
			query.Get("accountId"),
			WithParse[int64](parseInt64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "accountId", Err: err}, nil)
			return
		}

		accountIdParam = param
	} else {
		c.errorHandler(w, r, &RequiredError{Field: "accountId"}, nil)
		return
	}
	var personaIdParam int64
	if query.Has("personaId") {
		param, err := parseNumericParameter[int64](
			query.Get("personaId"),
			WithParse[int64](parseInt64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "personaId", Err: err}, nil)
			return
		}

		personaIdParam = param
	} else {
		c.errorHandler(w, r, &RequiredError{Field: "personaId"}, nil)
		return
	}
	result, err := c.service.DeletePersona(r.Context(), accountIdParam, personaIdParam)
	// If an error occurred, encode the error with the status code
	if err != nil {
		c.errorHandler(w, r, err, &result)
		return
	}
	// If no error, encode the body and the result code
	_ = EncodeJSONResponse(result.Body, &result.Code, w)
}

// GetPersonaList - Get Persona
func (c *PreviewPersonaAPIController) GetPersonaList(w http.ResponseWriter, r *http.Request) {
	query, err := parseQuery(r.URL.RawQuery)
	if err != nil {
		c.errorHandler(w, r, &ParsingError{Err: err}, nil)
		return
	}
	var accountIdParam int64
	if query.Has("accountId") {
		param, err := parseNumericParameter[int64](
			query.Get("accountId"),
			WithParse[int64](parseInt64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "accountId", Err: err}, nil)
			return
		}

		accountIdParam = param
	} else {
		c.errorHandler(w, r, &RequiredError{Field: "accountId"}, nil)
		return
	}
	var personaIdParam int64
	if query.Has("personaId") {
		param, err := parseNumericParameter[int64](
			query.Get("personaId"),
			WithParse[int64](parseInt64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "personaId", Err: err}, nil)
			return
		}

		personaIdParam = param
	} else {
		c.errorHandler(w, r, &RequiredError{Field: "personaId"}, nil)
		return
	}
	result, err := c.service.GetPersonaList(r.Context(), accountIdParam, personaIdParam)
	// If an error occurred, encode the error with the status code
	if err != nil {
		c.errorHandler(w, r, err, &result)
		return
	}
	// If no error, encode the body and the result code
	_ = EncodeJSONResponse(result.Body, &result.Code, w)
}

// SearchPersona - Search Personas
func (c *PreviewPersonaAPIController) SearchPersona(w http.ResponseWriter, r *http.Request) {
	query, err := parseQuery(r.URL.RawQuery)
	if err != nil {
		c.errorHandler(w, r, &ParsingError{Err: err}, nil)
		return
	}
	var accountIdParam int64
	if query.Has("accountId") {
		param, err := parseNumericParameter[int64](
			query.Get("accountId"),
			WithParse[int64](parseInt64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "accountId", Err: err}, nil)
			return
		}

		accountIdParam = param
	} else {
		c.errorHandler(w, r, &RequiredError{Field: "accountId"}, nil)
		return
	}
	var startParam int32
	if query.Has("start") {
		param, err := parseNumericParameter[int32](
			query.Get("start"),
			WithParse[int32](parseInt32),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "start", Err: err}, nil)
			return
		}

		startParam = param
	} else {
		c.errorHandler(w, r, &RequiredError{Field: "start"}, nil)
		return
	}
	var limitParam int32
	if query.Has("limit") {
		param, err := parseNumericParameter[int32](
			query.Get("limit"),
			WithParse[int32](parseInt32),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "limit", Err: err}, nil)
			return
		}

		limitParam = param
	} else {
		c.errorHandler(w, r, &RequiredError{Field: "limit"}, nil)
		return
	}
	result, err := c.service.SearchPersona(r.Context(), accountIdParam, startParam, limitParam)
	// If an error occurred, encode the error with the status code
	if err != nil {
		c.errorHandler(w, r, err, &result)
		return
	}
	// If no error, encode the body and the result code
	_ = EncodeJSONResponse(result.Body, &result.Code, w)
}

// UpdatePersona - Update Persona
func (c *PreviewPersonaAPIController) UpdatePersona(w http.ResponseWriter, r *http.Request) {
	query, err := parseQuery(r.URL.RawQuery)
	if err != nil {
		c.errorHandler(w, r, &ParsingError{Err: err}, nil)
		return
	}
	var accountIdParam int64
	if query.Has("accountId") {
		param, err := parseNumericParameter[int64](
			query.Get("accountId"),
			WithParse[int64](parseInt64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "accountId", Err: err}, nil)
			return
		}

		accountIdParam = param
	} else {
		c.errorHandler(w, r, &RequiredError{Field: "accountId"}, nil)
		return
	}
	var personaIdParam int64
	if query.Has("personaId") {
		param, err := parseNumericParameter[int64](
			query.Get("personaId"),
			WithParse[int64](parseInt64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "personaId", Err: err}, nil)
			return
		}

		personaIdParam = param
	} else {
		c.errorHandler(w, r, &RequiredError{Field: "personaId"}, nil)
		return
	}
	var titleParam string
	if query.Has("title") {
		param := query.Get("title")

		titleParam = param
	} else {
	}
	var previewAccountsParam string
	if query.Has("previewAccounts") {
		param := query.Get("previewAccounts")

		previewAccountsParam = param
	} else {
	}
	var activeParam bool
	if query.Has("active") {
		param, err := parseBoolParameter(
			query.Get("active"),
			WithParse[bool](parseBool),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "active", Err: err}, nil)
			return
		}

		activeParam = param
	} else {
	}
	var dateParam int64
	if query.Has("date") {
		param, err := parseNumericParameter[int64](
			query.Get("date"),
			WithParse[int64](parseInt64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "date", Err: err}, nil)
			return
		}

		dateParam = param
	} else {
	}
	var ageParam int32
	if query.Has("age") {
		param, err := parseNumericParameter[int32](
			query.Get("age"),
			WithParse[int32](parseInt32),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "age", Err: err}, nil)
			return
		}

		ageParam = param
	} else {
	}
	var genderParam string
	if query.Has("gender") {
		param := query.Get("gender")

		genderParam = param
	} else {
	}
	var gameExperienceLevelParam string
	if query.Has("gameExperienceLevel") {
		param := query.Get("gameExperienceLevel")

		gameExperienceLevelParam = param
	} else {
	}
	var latitudeParam float64
	if query.Has("latitude") {
		param, err := parseNumericParameter[float64](
			query.Get("latitude"),
			WithParse[float64](parseFloat64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "latitude", Err: err}, nil)
			return
		}

		latitudeParam = param
	} else {
	}
	var longitudeParam float64
	if query.Has("longitude") {
		param, err := parseNumericParameter[float64](
			query.Get("longitude"),
			WithParse[float64](parseFloat64),
		)
		if err != nil {
			c.errorHandler(w, r, &ParsingError{Param: "longitude", Err: err}, nil)
			return
		}

		longitudeParam = param
	} else {
	}
	result, err := c.service.UpdatePersona(r.Context(), accountIdParam, personaIdParam, titleParam, previewAccountsParam, activeParam, dateParam, ageParam, genderParam, gameExperienceLevelParam, latitudeParam, longitudeParam)
	// If an error occurred, encode the error with the status code
	if err != nil {
		c.errorHandler(w, r, err, &result)
		return
	}
	// If no error, encode the body and the result code
	_ = EncodeJSONResponse(result.Body, &result.Code, w)
}
